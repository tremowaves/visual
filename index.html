<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Swarm at WebGL Lab - Marco Gomez</title>
    <meta name="description" content="Swarm at Marco Gomez' WebGL Lab - @TheCodeTherapy">
    <!-- OG properties for sharing the Swarm scene -->
    <meta property="og:title" content="Swarm at WebGL Lab - Marco Gomez">
    <meta property="og:description" content="Swarm at Marco Gomez' WebGL Lab - @TheCodeTherapy">
    <meta property="og:image" content="./visual_files/Swarm.jpg">
    <meta property="og:image:alt" content="Swarm at WebGL Lab - @TheCodeTherapy">
    <meta property="og:image:type" content="image/jpeg">
    <meta property="og:image:width" content="1024">
    <meta property="og:image:height" content="1024">
    <meta property="og:locale" content="en">
    <meta property="og:site_name" content="mgz.me">

    <link data-next-font="" rel="preconnect" href="https://mgz.me/" crossorigin="anonymous">
    <link rel="stylesheet" href="./visual_files/09671da28aa56a04.css" data-n-g="">
    <!-- Font Awesome CDN for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <noscript data-n-css=""></noscript>
    <style>
        /* Basic Mobile Responsiveness for Controls */
        @media (max-width: 600px) {
            .main-contols-wrapper {
                height: 60px !important; /* Adjusted height */
                line-height: 60px !important;
                padding: 0 5px; /* Add some padding */
                box-sizing: border-box;
            }
            .toggler-wrapper {
                width: 50px !important; 
                height: 50px !important;
            }
            .control-buttons .button {
                width: 40px !important; /* Make buttons smaller */
                height: 40px !important;
                line-height: 40px !important; /* Center icon */
                font-size: 18px !important; /* Adjust icon size */
                margin: 0 2px !important; /* Reduce margin */
            }
            .home-page h1 { font-size: 1.8em; }
            .home-page h2 { font-size: 1.3em; }
            .home-page h3 { font-size: 1.1em; }
            .home-page h4 { font-size: 0.9em; }
            .home-page-image { max-width: 90%; margin-left: auto; margin-right: auto; display: block;}
        }
        /* Ensure canvas fills its container if JS doesn't override */
        #background_scene canvas {
            width: 100% !important;
            height: 100% !important;
        }
        .home-page-image {
             max-width: 100%;
             height: auto;
        }
    </style>
</head>
<body>
    <div id="__next">
        <div id="asset_loader_wrapper" class="asset-loader-wrapper"></div>
        <div id="rec_wrapper" class="rec-wrapper"></div>
        <div id="app_root">
            <div id="audio_load_bar" class="audio-load-bar"></div>
            <audio id="audio_player" style="display: none;">
                <!-- Source will be set by JavaScript -->
            </audio>
            <div role="presentation" id="background_scene" class="background-scene" style="position: fixed; top: 0px; left: 0px; width: 100vw; height: 100vh; z-index: 0; opacity: 0.4321;">
                <canvas data-engine="three.js r160" width="1432" height="718" class="renderer-canvas" style="display: block;"></canvas>
            </div>
            <div class="scene-nametag-wrapper">
                <span class="scene-info-tag" style="opacity: 0;">12/12</span>
                <span class="scene-name-tag" style="opacity: 0;">Swarm</span>
            </div>
            <div class="top-bar plain">
                <div class="loading-bar" id="loading_bar"></div>
            </div>
            <div class="main-contols-wrapper" style="height: 70px; line-height: 70px;">
                <div class="toggler-wrapper" style="width: 70px; height: 70px;">
                    <i class="fa-thin fa-power-off"></i><span class="temptip--triangle" data-tooltip="Play with me ðŸ˜‰"></span>
                </div>
                <div class="control-buttons">
                    <div id="load_audio_button" class="button fa-thin fa-circle-play inactive" style="color: rgb(204, 204, 204); text-shadow: none; animation-delay: 0s; cursor: default;">
                        <span class="tooltip--triangle load_audio" data-tooltip="I'm Audio-reactive! Try my Jam ðŸ˜ƒ"></span>
                    </div>
                    <div id="first_scene_button" class="button fa-thin fa-circle-chevron-up inactive" style="color: rgb(204, 204, 204); text-shadow: none; animation-delay: 0.12s; cursor: default;">
                        <span class="tooltip--triangle first_scene" data-tooltip="Rewind to First Scene"></span>
                    </div>
                    <div id="prev_scene_button" class="button fa-thin fa-circle-chevron-left inactive" style="color: rgb(204, 204, 204); text-shadow: none; animation-delay: 0.24s; cursor: default;">
                        <span class="tooltip--triangle prev_scene" data-tooltip="Load Previous Scene"></span>
                    </div>
                    <div id="next_scene_button" class="button fa-thin fa-circle-chevron-right inactive" style="color: rgb(204, 204, 204); text-shadow: none; animation-delay: 0.36s; cursor: default;">
                        <span class="tooltip--triangle next_scene" data-tooltip="Load Next Scene"></span>
                    </div>
                    <div id="rand_scene_button" class="button fa-thin fa-shuffle inactive" style="color: rgb(204, 204, 204); text-shadow: none; animation-delay: 0.48s; cursor: default;">
                        <span class="tooltip--triangle rand_scene" data-tooltip="Load Random Scene"></span>
                    </div>
                </div>
            </div>
            <section class="route-section">
                <div class="route-inner">
                    <div class="main">
                        <div class="content">
                            <div class="home-page">
                                <h1>Swarm</h1>
                                <h2>Marco Gomez' WebGL Portfolio</h2>
                                <h3>#Boids</h3>
                                <h4>by @TheCodeTherapy - https://mgz.me</h4>
                                <img alt="Instanced meshes governed by a flocking behaviour controller class in a universe of instanced star textured particles." loading="lazy" width="1024" height="1024" decoding="async" data-nimg="1" class="home-page-image" src="./visual_files/Swarm.jpg" style="color: transparent;">
                                <p>Instanced meshes governed by a flocking behaviour controller class in a universe of instanced star textured particles.</p>
                                <!-- Removed internal site navigation links -->
                            </div>
                        </div>
                    </div>
                </div>
            </section>
            <!-- Removed footer -->
        </div>
    </div>

    <!-- Core Next.js and scene-specific scripts (essential for functionality) -->
    <script defer="" nomodule="" src="./visual_files/polyfills-78c92fac7aa8fdd8.js"></script>
    <script src="./visual_files/webpack-edb2c4a2f993b241.js" defer=""></script>
    <script src="./visual_files/framework-64ad27b21261a9ce.js" defer=""></script>
    <script src="./visual_files/main-fdaa1ee0a0da5110.js" defer=""></script>
    <script src="./visual_files/_app-e5b0d1bc4a1b4a04.js" defer=""></script>
    <script src="./visual_files/962-e60f5ac397ddcfd8.js" defer=""></script>
    <script src="./visual_files/675-f8402c4ff683825d.js" defer=""></script>
    <script src="./visual_files/[scene]-065109fd0275efe4.js" defer=""></script>
    <script src="./visual_files/_buildManifest.js" defer=""></script>
    <script src="./visual_files/_ssgManifest.js" defer=""></script>
    
    <script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"scene":"Swarm","thumbURL":"/assets/thumbnails/Swarm.jpg"},"__N_SSG":true},"page":"/scenes/[scene]","query":{"scene":"Swarm"},"buildId":"muC72ZvF1QV4vWLtMoECr","isFallback":false,"gsp":true,"scriptLoader":[]}</script>

    <script>
        const audioPlayer = document.getElementById('audio_player');
        const loadAudioButton = document.getElementById('load_audio_button');

        // --- AUDIO PLAYLIST ---
        // MANUALLY define your audio file paths here.
        // Ensure these files exist in the './visual_files/audio/' directory 
        // or adjust paths accordingly.
        const playlist = [
            './visual_files/audio/tremowaves_postrock.mp3' // Original file
            // Example: add more tracks like so:
            // , './visual_files/audio/your_song_1.mp3',
            // , './visual_files/audio/another_track.ogg'
        ];
        let currentTrackIndex = 0;

        function loadTrack(trackIndex) {
            if (trackIndex >= 0 && trackIndex < playlist.length) {
                // Remove existing source elements before adding a new one
                while (audioPlayer.firstChild) {
                    audioPlayer.removeChild(audioPlayer.firstChild);
                }
                const sourceElement = document.createElement('source');
                sourceElement.setAttribute('src', playlist[trackIndex]);
                
                const fileExtension = playlist[trackIndex].split('.').pop().toLowerCase();
                if (fileExtension === 'mp3') {
                    sourceElement.setAttribute('type', 'audio/mpeg');
                } else if (fileExtension === 'ogg') {
                    sourceElement.setAttribute('type', 'audio/ogg');
                } else if (fileExtension === 'wav') {
                    sourceElement.setAttribute('type', 'audio/wav');
                } // Add more types as needed (e.g., 'aac', 'flac')

                audioPlayer.appendChild(sourceElement);
                audioPlayer.load(); // Important to load the new source
                currentTrackIndex = trackIndex;
                console.log("Loading track:", playlist[trackIndex]);
            } else {
                console.error("Track index out of bounds or playlist empty:", trackIndex);
                // Optionally, loop back to the first track or stop playback
                if (playlist.length > 0) {
                    currentTrackIndex = 0;
                    loadTrack(currentTrackIndex);
                }
            }
        }

        loadAudioButton.addEventListener('click', function() {
            // If player has no source or current source is empty, load first track
            if (!audioPlayer.currentSrc && playlist.length > 0) {
                loadTrack(currentTrackIndex);
            }

            if (playlist.length === 0) {
                console.warn("Playlist is empty. Add audio files to the playlist array in the script.");
                // Update button to show it's disabled or provide feedback
                loadAudioButton.classList.add('inactive');
                loadAudioButton.classList.remove('fa-circle-pause');
                loadAudioButton.classList.add('fa-circle-play');
                const tooltip = loadAudioButton.querySelector('.tooltip--triangle');
                if(tooltip) tooltip.setAttribute('data-tooltip', 'Playlist empty!');
                return;
            }
            
            if (audioPlayer.paused) {
                audioPlayer.play()
                    .then(() => {
                        // UI update handled by 'play' event listener
                    })
                    .catch(error => {
                        console.error("Error playing audio:", error);
                        // Handle error (e.g., user hasn't interacted with the page yet)
                         const tooltip = loadAudioButton.querySelector('.tooltip--triangle');
                         if(tooltip) tooltip.setAttribute('data-tooltip', 'Error playing. Click again?');
                    });
            } else {
                audioPlayer.pause();
                 // UI update handled by 'pause' event listener
            }
        });

        audioPlayer.addEventListener('ended', function() {
            console.log("Track ended. Loading next track.");
            currentTrackIndex = (currentTrackIndex + 1) % playlist.length;
            loadTrack(currentTrackIndex);
            audioPlayer.play().catch(error => console.error("Error auto-playing next track:", error));
        });
        
        audioPlayer.addEventListener('play', function() {
            loadAudioButton.classList.remove('inactive', 'fa-circle-play');
            loadAudioButton.classList.add('fa-circle-pause');
            const tooltip = loadAudioButton.querySelector('.tooltip--triangle');
            if(tooltip) tooltip.setAttribute('data-tooltip', 'Pause Audio');
        });

        audioPlayer.addEventListener('pause', function() {
            if (!audioPlayer.ended) { // Ensure it's a manual pause, not end of track
                loadAudioButton.classList.remove('fa-circle-pause');
                loadAudioButton.classList.add('inactive', 'fa-circle-play'); // inactive or just paused visual
                 const tooltip = loadAudioButton.querySelector('.tooltip--triangle');
                 if(tooltip) tooltip.setAttribute('data-tooltip', "I'm Audio-reactive! Try my Jam ðŸ˜ƒ");
            }
        });

        // Initialize: Load the first track metadata (but don't play yet)
        // This allows the browser to be ready if the user clicks play.
        if (playlist.length > 0) {
            loadTrack(0);
        } else {
            console.warn("Audio playlist is empty. Button functionality will be limited.");
            const tooltip = loadAudioButton.querySelector('.tooltip--triangle');
            if(tooltip) tooltip.setAttribute('data-tooltip', 'Playlist empty!');
        }
    </script>
</body>
</html>